<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>浏览器兼容性测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-item {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .pass {
            background-color: #d4edda;
            color: #155724;
        }
        .fail {
            background-color: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>Godot Web 浏览器兼容性测试</h1>
    
    <div id="results"></div>
    
    <h2>HTTP 头部信息</h2>
    <div id="headers"></div>
    
    <script>
        function checkFeature(name, test) {
            const result = document.createElement('div');
            result.className = 'test-item ' + (test ? 'pass' : 'fail');
            result.innerHTML = `${name}: ${test ? '✅ 支持' : '❌ 不支持'}`;
            return result;
        }
        
        const results = document.getElementById('results');
        
        // 检查各种功能
        results.appendChild(checkFeature('WebGL2', !!document.createElement('canvas').getContext('webgl2')));
        results.appendChild(checkFeature('SharedArrayBuffer', typeof SharedArrayBuffer !== 'undefined'));
        results.appendChild(checkFeature('CrossOriginIsolated', window.crossOriginIsolated === true));
        results.appendChild(checkFeature('SecureContext', window.isSecureContext === true));
        results.appendChild(checkFeature('Fetch API', 'fetch' in window));
        results.appendChild(checkFeature('WebAssembly', 'WebAssembly' in window));
        
        // 检查 HTTP 头部
        fetch(window.location.href)
            .then(response => {
                const headersDiv = document.getElementById('headers');
                const headers = {};
                
                for (let [key, value] of response.headers.entries()) {
                    headers[key] = value;
                }
                
                headersDiv.innerHTML = `
                    <pre>${JSON.stringify(headers, null, 2)}</pre>
                    <p>CrossOriginIsolated: ${window.crossOriginIsolated}</p>
                    <p>SecureContext: ${window.isSecureContext}</p>
                `;
            })
            .catch(err => {
                document.getElementById('headers').innerHTML = `错误: ${err.message}`;
            });
    </script>
</body>
</html>