<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ä¸­æ–‡ç¼–ç æµ‹è¯•</title>
    <style>
        body {
            font-family: "Microsoft YaHei", "SimHei", "é»‘ä½“", Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
            line-height: 1.6;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .chinese-text {
            font-size: 18px;
            color: #333;
            padding: 10px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            margin: 10px 0;
        }
        .encoding-info {
            font-family: monospace;
            background: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ‡¨ğŸ‡³ ä¸­æ–‡ç¼–ç æ£€æµ‹å’Œä¿®å¤</h1>
    
    <div class="test-section">
        <h3>æµ‹è¯•æ–‡æœ¬ï¼š</h3>
        <div class="chinese-text">
            ğŸ‰ åˆ‡è¥¿ç“œæ¸¸æˆ - å¹³è¡¡é¥¥é¥¿åº¦å’Œè¡€ç³–ï¼
        </div>
        <div class="chinese-text">
            æ¸¸æˆæ“ä½œï¼šé¼ æ ‡æ»‘åŠ¨åˆ‡å‰²è¥¿ç“œ | ç©ºæ ¼é”®æš‚åœ | æŒ‘æˆ˜ä½ çš„ç”Ÿå­˜æŠ€å·§
        </div>
        <div class="chinese-text">
            ç‰¹æ®Šè¥¿ç“œï¼šé‡‘è‰²è¥¿ç“œã€ç”œå‘³è¥¿ç“œã€è¿·ä½ è¥¿ç“œã€å·¨å‹è¥¿ç“œ
        </div>
    </div>

    <div class="test-section">
        <h3>ç¼–ç ä¿¡æ¯ï¼š</h3>
        <div class="encoding-info" id="encodingInfo">æ£€æµ‹ä¸­...</div>
    </div>

    <div class="test-section">
        <h3>ä¿®å¤å»ºè®®ï¼š</h3>
        <div id="fixSuggestions">ç”Ÿæˆä¸­...</div>
    </div>

    <div class="test-section">
        <h3>Godot æ¸¸æˆé“¾æ¥æµ‹è¯•ï¼š</h3>
        <p>ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥æµ‹è¯•æ¸¸æˆä¸­çš„ä¸­æ–‡æ˜¾ç¤ºï¼š</p>
        <a href="/games/watermelon/" target="_blank" style="
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 6px;
            margin-right: 10px;
        ">ğŸ® æ‰“å¼€æ¸¸æˆæµ‹è¯•ä¸­æ–‡</a>
    </div>

    <script>
        // æ£€æµ‹ç¼–ç ä¿¡æ¯
        function detectEncoding() {
            const info = {
                charset: document.characterSet || document.charset,
                contentType: document.contentType,
                documentElement: document.documentElement.lang,
                userAgent: navigator.userAgent,
                platform: navigator.platform
            };
            
            document.getElementById('encodingInfo').innerHTML = `
                <strong>æ–‡æ¡£å­—ç¬¦é›†:</strong> ${info.charset}<br>
                <strong>å†…å®¹ç±»å‹:</strong> ${info.contentType}<br>
                <strong>æ–‡æ¡£è¯­è¨€:</strong> ${info.documentElement}<br>
                <strong>ç”¨æˆ·ä»£ç†:</strong> ${info.userAgent}<br>
                <strong>å¹³å°:</strong> ${info.platform}
            `;
            
            return info;
        }

        // ç”Ÿæˆä¿®å¤å»ºè®®
        function generateFixSuggestions(info) {
            let suggestions = [];
            
            if (info.charset !== 'UTF-8') {
                suggestions.push('âŒ å­—ç¬¦é›†ä¸æ˜¯ UTF-8ï¼Œå»ºè®®ä¿®æ”¹ä¸º UTF-8');
            } else {
                suggestions.push('âœ… å­—ç¬¦é›†æ­£ç¡® (UTF-8)');
            }
            
            suggestions.push('<strong>å¯¹äº Godot æ¸¸æˆä¸­æ–‡ä¹±ç çš„ä¿®å¤æ–¹æ³•ï¼š</strong>');
            suggestions.push('1. ç¡®ä¿ Godot é¡¹ç›®ä¸­æ‰€æœ‰ .gd è„šæœ¬æ–‡ä»¶ä»¥ UTF-8 ç¼–ç ä¿å­˜');
            suggestions.push('2. åœ¨ Godot é¡¹ç›®è®¾ç½® â†’ æœ¬åœ°åŒ– â†’ è¯­è¨€ è®¾ä¸º "zh_CN"');
            suggestions.push('3. æ£€æŸ¥å¯¼å‡ºçš„ index.html æ–‡ä»¶å¤´éƒ¨æ˜¯å¦åŒ…å«æ­£ç¡®çš„ meta æ ‡ç­¾');
            suggestions.push('4. ç¡®ä¿ Web æœåŠ¡å™¨è¿”å›æ­£ç¡®çš„ Content-Type å¤´éƒ¨');
            
            suggestions.push('<strong>å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼š</strong>');
            suggestions.push('â€¢ åœ¨ Godot ç¼–è¾‘å™¨ä¸­ï¼šç¼–è¾‘å™¨è®¾ç½® â†’ ç½‘ç»œ â†’ è°ƒè¯• â†’ è¿œç¨‹ç«¯å£ è®¾ä¸ºåˆé€‚å€¼');
            suggestions.push('â€¢ é‡æ–°å¯¼å‡ºæ¸¸æˆæ—¶ï¼Œé€‰æ‹© "è°ƒè¯•" æ¨¡å¼è€Œä¸æ˜¯ "å‘å¸ƒ" æ¨¡å¼');
            suggestions.push('â€¢ æ£€æŸ¥ vercel.json æ˜¯å¦åŒ…å«æ­£ç¡®çš„ Content-Type å¤´éƒ¨');
            
            document.getElementById('fixSuggestions').innerHTML = suggestions.map(s => 
                s.startsWith('â€¢') || s.startsWith('âŒ') || s.startsWith('âœ…') || /^\d+\./.test(s) 
                    ? `<div style="margin: 5px 0; padding-left: 20px;">${s}</div>`
                    : `<div style="margin: 10px 0; font-weight: bold;">${s}</div>`
            ).join('');
        }

        // æ‰§è¡Œæ£€æµ‹
        const encodingInfo = detectEncoding();
        generateFixSuggestions(encodingInfo);

        // æµ‹è¯•ä¸­æ–‡å­—ç¬¦çš„å­—èŠ‚è¡¨ç¤º
        const testText = "åˆ‡è¥¿ç“œæ¸¸æˆ";
        console.log('ä¸­æ–‡æµ‹è¯•å­—ç¬¦:', testText);
        console.log('å­—ç¬¦é•¿åº¦:', testText.length);
        console.log('å­—èŠ‚è¡¨ç¤º:', new TextEncoder().encode(testText));
    </script>
</body>
</html>